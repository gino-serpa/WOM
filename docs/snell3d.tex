\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\begin{document}
Since the refracted ray should be in the same plane as the incident ray and the normal we should be able to express it as:

\[
\hat r_r = \alpha  \hat n + \beta \hat r_i
\]

$\alpha$ and $\beta$ can be obtained from the noting that $\hat r_i$ is a unit vector 
and Snell's law:

\begin{align*}
\hat r_i \cdot \hat r_i                                                   & = 1 \\
(\alpha  \hat n + \beta \hat r_i) \cdot (\alpha  \hat n + \beta \hat r_i) & = 1 \\
\alpha^2 + \beta^2 + 2 \alpha \beta (\hat n \cdot \hat r_i)               & = 1 
\end{align*}


and from Snell

\[
n_i \sin{\theta_i} = n_r \sin{\theta_r}
\Rightarrow
\theta_r = \arcsin{ \left( \dfrac{n_i}{n_r}\sin{\theta_i} \right) }
\]

where

\begin{align*}
\cos \theta_i  & = -\hat n \cdot \hat r_i                          \\
\theta_i       & = \arccos{\left( -\hat n \cdot \hat r_i \right)} 
\end{align*}



And the expression for the angle on the refracted side:

\begin{align*}
-\hat n \cdot \hat r_r                          & = \cos\theta_r  \\
(-\hat n)\cdot (\alpha \hat n +\beta \hat r_i)  & = \cos\theta_r  \\
-\alpha-\beta (\hat n\cdot \hat r_i)            & = \cos\theta_r  \\
\alpha                           & = -\cos\theta_r -\beta(n \cdot r_i) 
\end{align*}


replacing this in the first equation

\[
(- \cos\theta_r - \beta (\hat n \cdot \hat r_i))^2+ \beta^2 + 2(-\cos\theta_r-\beta(\hat n\cdot \hat r_i))\beta(\hat n \cdot \hat r_i)=1
\]

\[
(1-(\hat n\cdot \hat r_i)^2)\beta^2 = 1-\cos^2\theta_r
\]

\[
\beta = + \sqrt{\dfrac{1-\cos^2\theta_r}{1-(\hat n \cdot \hat r_i)^2}}
= \dfrac{\sin\theta_r}{\sin\theta_i}
\]

So that $\hat r_r$ can be expressed as:

\[
\hat r_r = \left( -\cos\theta_r+\left( \dfrac{\sin\theta_r}{\sin\theta_i}\right) \cos\theta_i \right) \hat n + 
\dfrac{\sin\theta_r}{\sin\theta_i} \hat r_i
\]

\end{document}